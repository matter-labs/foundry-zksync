<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Finds the anchor corresponding to a branch item."><title>find_anchor_branch in foundry_evm_coverage::anchors - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-405f8b29f52305f8.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="foundry_evm_coverage" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0-nightly (f79a912d9 2024-09-18)" data-channel="nightly" data-search-js="search-0cfde64e8ad3a7fe.js" data-settings-js="settings-7e3bb6c46e92e77c.js" ><script src="../../static.files/storage-29b1d5a9048d38fe.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-14659ec02b58af51.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-40f72c9259523cb3.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../foundry_evm_coverage/index.html">foundry_<wbr>evm_<wbr>coverage</a><span class="version">0.2.0</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"><h2><a href="index.html">In foundry_<wbr>evm_<wbr>coverage::<wbr>anchors</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">foundry_evm_coverage</a>::<wbr><a href="index.html">anchors</a>::<wbr><a class="fn" href="#">find_anchor_branch</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/foundry_evm_coverage/anchors.rs.html#108-169">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn find_anchor_branch(
    bytecode: &amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>],
    source_map: &amp;SourceMap,
    item_id: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>,
    loc: &amp;<a class="struct" href="../struct.SourceLocation.html" title="struct foundry_evm_coverage::SourceLocation">SourceLocation</a>,
) -&gt; <a class="type" href="https://docs.rs/eyre/0.6.12/eyre/type.Result.html" title="type eyre::Result">Result</a>&lt;(<a class="struct" href="../struct.ItemAnchor.html" title="struct foundry_evm_coverage::ItemAnchor">ItemAnchor</a>, <a class="struct" href="../struct.ItemAnchor.html" title="struct foundry_evm_coverage::ItemAnchor">ItemAnchor</a>)&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Finds the anchor corresponding to a branch item.</p>
<p>This finds the relevant anchors for a branch coverage item. These anchors
are found using the bytecode of the contract in the range of the branching node.</p>
<p>For <code>IfStatement</code> nodes, the template is generally:</p>
<div class="example-wrap"><pre class="language-text"><code>&lt;condition&gt;
PUSH &lt;ic if false&gt;
JUMPI
&lt;true branch&gt;
&lt;...&gt;
&lt;false branch&gt;
</code></pre></div>
<p>For <code>assert</code> and <code>require</code>, the template is generally:</p>
<div class="example-wrap"><pre class="language-text"><code>PUSH &lt;ic if true&gt;
JUMPI
&lt;revert&gt;
&lt;...&gt;
&lt;true branch&gt;
</code></pre></div>
<p>This function will look for the last JUMPI instruction, backtrack to find the program
counter of the first branch, and return an item for that program counter, and the
program counter immediately after the JUMPI instruction.</p>
</div></details></section></div></main></body></html>